<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TITAN v9.6 PRO + TIME ZONE</title>
    <style>
        /* --- TITAN THEME (Professional Dark) --- */
        :root { --bg: #0f172a; --panel: #1e293b; --text: #f1f5f9; --accent: #38bdf8; --gold: #facc15; --win: #4ade80; --loss: #f87171; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); color: var(--text); padding: 15px; margin: 0; display: flex; justify-content: center; }
        
        .app-box { 
            width: 100%; max-width: 480px; background: var(--panel); 
            border-radius: 16px; overflow: hidden; border: 1px solid #334155;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        /* HEADER */
        .header { background: #020617; padding: 20px; text-align: center; border-bottom: 2px solid var(--accent); }
        h1 { margin: 0; font-size: 24px; color: var(--accent); letter-spacing: 2px; font-weight: 900; }
        .status { font-size: 11px; color: #94a3b8; margin-top: 5px; }

        /* TIME ZONE BAR (NEW) */
        .time-bar {
            padding: 8px; text-align: center; font-size: 12px; font-weight: bold;
            border-bottom: 1px solid #334155; letter-spacing: 1px;
        }
        .t-best { background: rgba(74, 222, 128, 0.15); color: var(--win); border-bottom-color: var(--win); }
        .t-danger { background: rgba(248, 113, 113, 0.15); color: var(--loss); border-bottom-color: var(--loss); }
        .t-normal { background: rgba(250, 204, 21, 0.15); color: var(--gold); border-bottom-color: var(--gold); }

        /* PROFIT DASHBOARD */
        .dashboard { display: grid; grid-template-columns: 1fr 1fr; gap: 1px; background: #334155; }
        .card { background: var(--panel); padding: 15px; text-align: center; }
        .label { font-size: 10px; color: #94a3b8; font-weight: bold; letter-spacing: 1px; }
        .value { font-size: 22px; font-weight: 800; display: block; margin-top: 5px; }
        .v-bs { color: var(--win); }
        .v-num { color: var(--gold); }

        /* PREDICTION AREA */
        .pred-area { padding: 25px; text-align: center; background: radial-gradient(circle, #1e293b 0%, #0f172a 100%); border-bottom: 1px solid #334155; }
        .p-title { font-size: 11px; color: #64748b; letter-spacing: 2px; margin-bottom: 10px; }
        .p-main { font-size: 52px; font-weight: 900; color: #fff; line-height: 1; margin: 0; text-shadow: 0 0 20px rgba(56, 189, 248, 0.2); }
        .p-nums { font-size: 20px; color: var(--gold); font-weight: bold; margin-top: 10px; letter-spacing: 2px; }
        .p-note { font-size: 12px; background: #334155; padding: 4px 10px; border-radius: 4px; color: #cbd5e1; display: inline-block; margin-top: 15px; }

        /* CONTROLS */
        .controls { padding: 20px; }
        .inputs { display: flex; gap: 10px; margin-bottom: 15px; }
        
        .p-input { width: 80px; padding: 14px; background: #020617; border: 1px solid #334155; color: #64748b; font-weight: bold; text-align: center; border-radius: 8px; font-size: 16px; outline: none; }
        .p-input:focus { border-color: var(--accent); color: #fff; }
        .p-input:disabled { opacity: 0.8; border-color: var(--accent); color: var(--accent); }

        .r-input { flex: 1; padding: 14px; background: #020617; border: 1px solid var(--accent); color: #fff; font-weight: bold; text-align: center; border-radius: 8px; font-size: 18px; outline: none; }
        
        .btn-row { display: flex; gap: 10px; }
        .btn { border: none; padding: 16px; border-radius: 8px; font-weight: 800; cursor: pointer; flex: 1; font-size: 14px; transition: 0.2s; }
        .btn-undo { background: #334155; color: #94a3b8; flex: 0.3; }
        .btn-go { background: var(--accent); color: #0f172a; box-shadow: 0 4px 15px rgba(56, 189, 248, 0.3); }
        .btn-go:active { transform: scale(0.98); }
        .btn-reset { width: 100%; margin-top: 15px; background: transparent; border: 1px solid #f87171; color: #f87171; padding: 10px; font-size: 11px; }

        /* TABLE */
        .table-wrap { max-height: 250px; overflow-y: auto; border-top: 1px solid #334155; }
        table { width: 100%; border-collapse: collapse; font-size: 12px; }
        th { text-align: left; padding: 10px 15px; color: #64748b; background: #020617; position: sticky; top: 0; font-size: 10px; }
        td { padding: 10px 15px; border-bottom: 1px solid #334155; color: #cbd5e1; }
        .badge { padding: 3px 6px; border-radius: 4px; font-weight: bold; font-size: 10px; }
        .b-win { background: rgba(74, 222, 128, 0.2); color: var(--win); } 
        .b-loss { background: rgba(248, 113, 113, 0.2); color: var(--loss); }
    </style>
</head>
<body>

<div class="app-box">
    <div class="header">
        <h1>TITAN v9.6</h1>
        <div class="status">Official ‚Ä¢ Dual Tracker ‚Ä¢ 3-Num Logic</div>
    </div>

    <div id="timeStatus" class="time-bar t-normal">Checking Market...</div>

    <div class="dashboard">
        <div class="card">
            <div class="label">B/S PROFIT</div>
            <span class="value v-bs" id="bsProfit">0</span>
            <div class="label" style="margin-top:5px; color:#64748b;">Level: <span id="bsLevel" style="color:#f87171">0</span></div>
        </div>
        <div class="card">
            <div class="label">NUM PROFIT</div>
            <span class="value v-num" id="numProfit">0</span>
            <div class="label" style="margin-top:5px; color:#64748b;">Level: <span id="numLevel" style="color:#f87171">0</span></div>
        </div>
    </div>

    <div id="predBox" class="pred-area">
        <div class="p-title">RECOMMENDED BET</div>
        <div class="p-main" id="pMain">---</div>
        <div class="p-nums" id="pNums">---</div>
        <div class="p-note" id="pDesc">Enter Start Period & Result</div>
    </div>

    <div class="controls">
        <div class="inputs">
            <input type="number" id="periodInput" class="p-input" placeholder="Period">
            <input type="number" id="resultInput" class="r-input" placeholder="Result (0-9)" min="0" max="9" onkeypress="handleEnter(event)">
        </div>
        <div class="btn-row">
            <button class="btn btn-undo" onclick="undoLast()">‚Ü©</button>
            <button class="btn btn-go" onclick="processRound()">ANALYZE</button>
        </div>
        <button class="btn btn-reset" onclick="hardReset(true)">‚ö†Ô∏è FULL SYSTEM RESET</button>
    </div>

    <div class="table-wrap">
        <table id="historyTable">
            <thead>
                <tr>
                    <th>PD</th>
                    <th>RES</th>
                    <th>PRED</th>
                    <th>BS</th>
                    <th>NUM</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<script>
    // === CONFIGURATION ===
    const BS_UNIT = 10;   
    const NUM_PROG = [1, 2, 5, 10, 20, 50]; // Custom Aggressive Plan
    
    // === STATE ===
    let state = {
        history: [],
        bsLevel: 0,
        numLevel: 0,
        bsProfit: 0,
        numProfit: 0,
        currentPred: null,
        wins: 0
    };

    window.onload = function() {
        loadState();
        checkMarketTime();
        setInterval(checkMarketTime, 60000); // Check time every minute
    };

    // === NEW TIME ZONE LOGIC ===
    function checkMarketTime() {
        const now = new Date();
        const h = now.getHours();
        const m = now.getMinutes();
        const el = document.getElementById('timeStatus');

        // Best: 05:30-08:30 AND 14:00-16:00
        const isMorningBest = (h === 5 && m >= 30) || (h >= 6 && h < 8) || (h === 8 && m <= 30);
        const isAfternoonBest = (h >= 14 && h < 16);
        
        // Danger: 18:00 - 23:00
        const isDanger = (h >= 18 && h < 23);

        if (isMorningBest || isAfternoonBest) {
            el.className = "time-bar t-best";
            el.innerHTML = "‚úÖ BEST TIME: MARKET STABLE (Dragon/ZigZag)";
        } else if (isDanger) {
            el.className = "time-bar t-danger";
            el.innerHTML = "‚õî DANGER ZONE: CHOPPY MARKET (Avoid)";
        } else {
            el.className = "time-bar t-normal";
            el.innerHTML = "‚ö†Ô∏è NORMAL ZONE: Play Carefully";
        }
    }

    function handleEnter(e) { if(e.key === 'Enter') processRound(); }
    function saveState() { localStorage.setItem("titan_v96_final", JSON.stringify(state)); }
    
    function loadState() {
        const stored = localStorage.getItem("titan_v96_final");
        if(stored) {
            state = JSON.parse(stored);
            rebuildTable();
            if(state.currentPred) displayPred(state.currentPred);
            if(state.history.length > 0) {
                let nextP = parseInt(state.history[0].period) + 1;
                let pInput = document.getElementById("periodInput");
                pInput.value = nextP;
                pInput.disabled = true;
            }
        }
        updateUI();
    }

    // === CORE PROCESSOR ===
    function processRound() {
        let rInput = document.getElementById("resultInput");
        let pInput = document.getElementById("periodInput");
        
        let result = parseInt(rInput.value);
        let period = parseInt(pInput.value);

        if (isNaN(period) || period <= 0) { alert("Enter Period Number!"); return; }
        if (isNaN(result) || result < 0 || result > 9) { alert("Enter Result (0-9)!"); return; }

        let actualBS = result >= 5 ? "Big" : "Small";

        // 1. Evaluate
        let bsOut = "-", numOut = "-";
        let bsChange = 0, numChange = 0;

        if (state.currentPred && state.currentPred.reason !== "Start") {
            // Big/Small Eval (Martingale)
            let bsBetAmt = BS_UNIT * Math.pow(2, state.bsLevel);
            if (state.currentPred.bs === actualBS) {
                bsOut = "WIN";
                bsChange = bsBetAmt; 
                state.bsLevel = 0;
                state.wins++;
            } else {
                bsOut = "LOSS";
                bsChange = -bsBetAmt;
                state.bsLevel++;
            }

            // Number Eval (3 Numbers Custom Progression)
            let currentNumUnit = NUM_PROG[Math.min(state.numLevel, 5)];
            let totalNumBet = currentNumUnit * 3; 

            if (state.currentPred.nums.includes(result)) {
                numOut = "WIN";
                numChange = (currentNumUnit * 9) - totalNumBet;
                state.numLevel = 0;
            } else {
                numOut = "LOSS";
                numChange = -totalNumBet;
                state.numLevel++;
            }
        }

        state.bsProfit += bsChange;
        state.numProfit += numChange;

        // 2. Add History
        state.history.unshift({
            period: period,
            res: result,
            bs: actualBS,
            predBS: state.currentPred ? state.currentPred.bs : "-",
            predNums: state.currentPred ? state.currentPred.nums : [],
            bsOut: bsOut,
            numOut: numOut
        });

        // 3. UI Flow
        pInput.value = period + 1;
        pInput.disabled = true;
        
        if (state.wins >= 10) setTimeout(()=> alert("üèÜ 10 WINS REACHED! Reset Recommended."), 100);
        if (state.bsLevel >= 6) setTimeout(()=> alert("üõë STOP LOSS ALERT! Level 6 reached."), 100);

        titanLogic(state.history);
        updateTable(state.history[0]);
        updateUI();
        saveState();
        
        rInput.value = "";
        rInput.focus();
    }

    // === LOGIC ENGINE ===
    function titanLogic(hist) {
        if (hist.length === 0) {
            state.currentPred = { bs: "Small", nums: [0, 1, 2], reason: "Start" };
            displayPred(state.currentPred);
            return;
        }

        let last = hist[0];
        let predBS = last.bs; 
        let reason = "Trend";

        let streak = 1;
        for(let i=1; i<hist.length; i++) {
            if(hist[i].bs === last.bs) streak++; else break;
        }

        // Logic Switcher
        if (state.bsLevel >= 2) {
            if (streak >= 2) predBS = (last.bs === "Big") ? "Small" : "Big"; 
            else predBS = last.bs; 
            reason = "Anti-Trap";
        } 
        else if (streak >= 4) {
            predBS = (last.bs === "Big") ? "Small" : "Big"; 
            reason = "Streak Break";
        }
        else {
            predBS = last.bs; 
            reason = "Trend Ride";
        }

        // 3-Number Neighbors
        let nums = [];
        let ln = last.res;
        if (predBS === "Big") {
            if (ln === 5) nums = [6, 7, 8]; 
            else if (ln === 6) nums = [5, 7, 8]; 
            else if (ln === 7) nums = [6, 8, 9]; 
            else if (ln === 8) nums = [7, 9, 6]; 
            else if (ln === 9) nums = [7, 8, 9]; 
            else nums = [5, 7, 9]; 
        } else {
            if (ln === 0) nums = [1, 2, 3]; 
            else if (ln === 1) nums = [0, 2, 3]; 
            else if (ln === 2) nums = [1, 3, 4]; 
            else if (ln === 3) nums = [1, 2, 4]; 
            else if (ln === 4) nums = [1, 2, 3]; 
            else nums = [0, 2, 4]; 
        }

        state.currentPred = { bs: predBS, nums: nums, reason: reason };
        displayPred(state.currentPred);
    }

    function displayPred(pred) {
        document.getElementById("predBox").style.display = "block";
        let main = document.getElementById("pMain");
        main.innerText = pred.bs.toUpperCase();
        main.style.color = pred.bs === "Big" ? "#ff6b6b" : "#1dd1a1"; 
        
        document.getElementById("pNums").innerText = pred.nums.join(" ‚Ä¢ ");
        document.getElementById("pDesc").innerText = pred.reason;
    }

    function updateUI() {
        document.getElementById("bsProfit").innerText = state.bsProfit;
        document.getElementById("numProfit").innerText = state.numProfit;
        document.getElementById("bsLevel").innerText = state.bsLevel;
        document.getElementById("numLevel").innerText = state.numLevel;
    }

    function updateTable(item) {
        const tbody = document.getElementById("historyTable").querySelector("tbody");
        const row = tbody.insertRow(0);
        
        let bsBadge = item.bsOut === "WIN" ? "b-win" : (item.bsOut === "LOSS" ? "b-loss" : "");
        let numBadge = item.numOut === "WIN" ? "b-win" : (item.numOut === "LOSS" ? "b-loss" : "");
        let resCol = item.bs === "Big" ? "#ff6b6b" : "#1dd1a1";

        let bsTxt = item.bsOut === "-" ? "-" : `<span class="badge ${bsBadge}">${item.bsOut.charAt(0)}</span>`;
        let numTxt = item.numOut === "-" ? "-" : `<span class="badge ${numBadge}">${item.numOut.charAt(0)}</span>`;

        row.innerHTML = `
            <td>${item.period}</td>
            <td>${item.res} <span style="color:${resCol}">(${item.bs.charAt(0)})</span></td>
            <td>${item.predBS.charAt(0)} [${item.predNums.join('')}]</td>
            <td>${bsTxt}</td>
            <td>${numTxt}</td>
        `;
    }

    function rebuildTable() {
        document.getElementById("historyTable").querySelector("tbody").innerHTML = "";
        [...state.history].reverse().forEach(item => updateTable(item));
    }

    function undoLast() {
        if(state.history.length === 0) return;
        if(confirm("Undo last?")) {
            state.history.shift();
            alert("Undo successful. Metrics reset to ensure accuracy. Please re-enter last valid result if needed.");
            hardReset(false);
        }
    }

    function hardReset(confirmUser) {
        if(confirmUser && !confirm("RESET ALL?")) return;
        localStorage.removeItem("titan_v96_final");
        location.reload();
    }
</script>

</body>
</html>